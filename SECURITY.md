# SECURITY

> Безопасность — приоритет проекта **OmniFlow**.

Этот файл описывает, как сообщать о проблемах безопасности, как мы их обрабатываем и чего ожидать от команды.

---

## 1. Кратко

* **Не публикуйте** найденные уязвимости публично (issues, форумы, социальные сети) до согласованного раскрытия.
* Отправляйте отчёт приватно через **GitHub Security Advisory** или зашифрованной PGP-почтой на адрес, указанный в `SECURITY_CONTACT` в настройках репозитория.
* В ответ мы подтверждаем получение и начинаем triage.

---

## 2. Кому отправлять

**Предпочтительные каналы (в порядке приоритета):**

1. **GitHub Security Advisory** для этого репозитория. (Рекомендуется — приватное обсуждение и трекинг.)
2. **PGP‑зашифрованное письмо** на `security@cajeer.com`.
3. В экстренном случае — приватное сообщение владельцу репозитория через GitHub.

**Пожалуйста, не создавайте публичные Issues до согласованного раскрытия.**

---

## 3. PGP / шифрование

Мы принимаем PGP‑зашифрованные сообщения. Ниже — пример-заполнитель для открытого ключа — замените на реальный публичный PGP‑ключ проекта.

```
OmniFlow Security PGP Key (placeholder)
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: OpenPGP

<REPLACE_WITH_PROJECT_PGP_PUBLIC_KEY>
-----END PGP PUBLIC KEY BLOCK-----
```

**Как зашифровать:**

```bash
# импорт публичного ключа (если у вас есть файл recipient.pub)
gpg --import recipient.pub

# зашифровать сообщение
gpg --encrypt --recipient "OmniFlow Security" --armor report.txt > encrypted.asc
```

При отправке укажите в теле письма краткое резюме и пометьте, что подробности во вложении `encrypted.asc`.

---

## 4. Что включать в отчёт (обязательное минимум и желательные детали)

**Минимум:**

* Название: короткое описание уязвимости.
* Версия OmniFlow: тег/commit SHA и способ установки (docker, from-source и т.д.).
* Краткая инструкция для воспроизведения (Steps to reproduce) или PoC.
* Контакт: email и удобные часы/часовой пояс.

**Желательно (ускоряет triage):**

* Среда (OS, Docker image:tag, архитектура).
* Полный PoC (curl, скрипт, пример кода).
* Логи, трассировки и дампы (если безопасно).
* Оценка влияния и возможный вектор атаки.
* Упоминание сторонних библиотек/зависимостей, если применимо.

**Шаблон:**

```
Title: [Короткое описание]
Version: vX.Y.Z (commit: <sha>)
Installation: docker-compose up (image: ...), или source build
OS/Env: Ubuntu 22.04; Docker 24.0; arch x86_64
Steps to reproduce:
1) ...
2) ...
PoC: [код/curl/скрипт]
Impact: [что может сделать злоумышленник]
Contact: your.name@example.com
```

---

## 5. Процесс обработки и ожидаемые сроки (SLA)

**После получения приватного отчёта:**

1. **Подтверждение получения** — в течение **48 часов** (рабочие дни).
2. **Triage / первичная оценка** — в течение **5 рабочих дней** (включая воспроизводимость и первоначальную классификацию).
3. **Разработка исправления** — приоритеты зависят от серьёзности:

   * **Critical:** целевое исправление в **7–14 дней**.
   * **High:** исправление в ранних релизах / хотфиксах.
   * **Medium/Low:** по обычному релизному циклу.
4. **Согласованное раскрытие:** как правило — после выпуска исправления; рекомендованный период координации — **30 дней**, может корректироваться.

> Примечание: сроки — ориентировочные. Могут меняться в зависимости от сложности и доступности ресурсов.

---

## 6. Классификация серьёзности (примерная)

* **Critical** — RCE без взаимодействия пользователя, компрометация приватных ключей, утечка секретов.
* **High** — обход аутентификации, эскалация привилегий, утечка PII.
* **Medium** — уязвимости, требующие взаимодействия или имеющие ограниченный вектор атаки.
* **Low** — косметические/информационные баги.

Если вы не уверены — опишите подробно, мы поможем с классификацией.

---

## 7. Публикация исправлений и уведомления

* Исправления выпускаются через GitHub Releases; в релизе указываются инструкции по обновлению и mitigation.
* При необходимости проект инициирует присвоение CVE.
* Docker образы и зависимости обновляются с новыми тегами/sha; указываются в релизе.

---

## 8. Зависимости и цепочка поставок

OmniFlow использует внешние зависимости (npm, pip, go.mod и др.).

Рекомендуется:

* Использовать Dependabot/OSV/Snyk для автоматического сканирования.
* Сообщать о проблемах в зависимостях через соответствующие каналы (репозиторий зависимости).

---

## 9. Рекомендации для контрибьюторов и мейнтейнеров

* Принцип минимальных привилегий для сервисов и учетных записей.
* Избегать `eval` и исполнения непроверённого кода. Если выполнение кода требуется, применять жёсткую песочницу и ограничение ресурсов.
* Обязательная валидация и санация всех входных данных (API, UI, конфигурации).
* Использовать SAST/DAST и покрытие тестами безопасности в CI.
* Подписывать релизы и контейнерные образы.

---

## 10. Баг баунти и кредиты

На текущий момент **официальной программы вознаграждений нет**.

Мы благодарим исследователей и указываем авторство в security advisory после согласованного раскрытия, если исследователь согласен.

---

## 11. Safe harbor и правовые гарантии

Мы стремимся к этичному взаимодействию. Люди, действующие добросовестно, следуя рекомендациям этого файла, не будут подвергаться юридическим преследованиям со стороны проекта. Пожалуйста, не эксплуатируйте уязвимости в продакшн-средах.

---

## 12. Экстренные действия (компрометация ключей/учёток)

Если вы считаете, что ключи проекта или учётные записи скомпрометированы:

1. Немедленно свяжитесь приватно с `security@cajeer.com`.
2. Укажите детали компрометации и приложите доказательства.
3. Мы выполним ротацию ключей, перегенерацию токенов и уведомим пользователей при необходимости.

---

## 13. Контакты (пример)

* **Primary:** GitHub Security Advisory (репозиторий).
* **PGP‑защищённая почта:** `security@cajeer.com`.

---

## 14. Пример заголовка письма

```
Subject: [SECURITY] OmniFlow — Remote code execution in <component> (vX.Y.Z)
Attachment: encrypted.asc (PGP)
```

---

## 15. Благодарности

Спасибо за помощь в повышении безопасности OmniFlow. Любая приватная проверка и репорт помогают защитить пользователей.

---

*Авторы/поддержка:* TheSkiF4er — мейнтейнер(ы) проекта.
