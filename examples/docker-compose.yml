version: "3.9"

services:
  # =========================
  # Core engine example
  # =========================
  core:
    image: omniflow/core:latest
    container_name: omniflow-core-example
    ports:
      - "8080:8080"
    environment:
      OMNIFLOW_ENV: demo
      DB_HOST: db
      DB_PORT: 5432
      REDIS_HOST: redis
      REDIS_PORT: 6379
    depends_on:
      - db
      - redis

  # =========================
  # UI (React example)
  # =========================
  ui:
    image: omniflow/ui:latest
    container_name: omniflow-ui-example
    ports:
      - "3000:3000"
    depends_on:
      - core

  # =========================
  # PostgreSQL Database for example
  # =========================
  db:
    image: postgres:16-alpine
    container_name: omniflow-db-example
    environment:
      POSTGRES_USER: omniflow
      POSTGRES_PASSWORD: example
      POSTGRES_DB: omniflow_demo
    ports:
      - "5433:5432"
    volumes:
      - db_data_example:/var/lib/postgresql/data

  # =========================
  # Redis (for queues/events)
  # =========================
  redis:
    image: redis:8-alpine
    container_name: omniflow-redis-example
    ports:
      - "6380:6379"
    volumes:
      - redis_data_example:/data

# =========================
# Volumes
# =========================
volumes:
  db_data_example:
  redis_data_example:
  
